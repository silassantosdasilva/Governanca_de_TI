@model Governança_de_TI.Models.DashboardWidgetModel

<!-- ========================================================= -->
<!-- 🧭 CABEÇALHO DO MODAL -->
<!-- ========================================================= -->
<div class="modal-header bg-light border-0">
    <h5 class="modal-title fw-semibold text-dark">
        <i class="bi bi-grid-fill text-primary me-2"></i>
        @((Model.Id == 0) ? "Novo Widget" : "Editar Widget")
    </h5>
    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
</div>

<!-- ========================================================= -->
<!-- 🧩 FORMULÁRIO DO WIZARD -->
<!-- ========================================================= -->
<form id="widgetWizardForm" method="post">
    <div class="modal-body">
        <!-- ========================= -->
        <!-- ETAPA 1 -->
        <!-- ========================= -->
        <div class="wizard-step" id="step1">
            <h6 class="fw-semibold mb-3 text-primary">PASSO 1: O que exibir?</h6>
            <div class="row g-3">
                <div class="col-md-7">
                    <label for="tituloWidget" class="form-label fw-semibold">Título do Widget</label>
                    <input id="tituloWidget" class="form-control" placeholder="Ex: Equipamentos por Status" />
                </div>
                <div class="col-md-5">
                    <label for="tipoVisualizacao" class="form-label fw-semibold">Tipo de Visualização</label>
                    <select id="tipoVisualizacao" class="form-select">
                        <option value="">Carregando tipos...</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- ========================= -->
        <!-- ETAPA 2 -->
        <!-- ========================= -->
        <div class="wizard-step d-none" id="step2">
            <h6 class="fw-semibold mb-3 text-primary">PASSO 2: De onde virão os dados?</h6>
            <div class="mb-3">
                <label class="form-label fw-semibold">Tabela Fonte</label>
                <select id="tabelaFonte" class="form-select">
                    <option value="">Carregando tabelas...</option>
                </select>
            </div>
        </div>

        <!-- ========================= -->
        <!-- ETAPA 3 -->
        <!-- ========================= -->
        <div class="wizard-step d-none" id="step3">

            <h6 class="fw-semibold mb-3 text-primary">PASSO 3: Como calcular?</h6>

            <div id="bloco-agregacao">
                <div class="row g-3">
                    <div class="col-md-6">
                        <label class="form-label fw-semibold">Operação</label>
                        <select id="operacaoWidget" class="form-select">
                            <option value="Contagem">Contagem</option>
                            <option value="Soma">Soma</option>
                            <option value="Media">Média</option>
                        </select>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label fw-semibold">Campo Métrica</label>
                        <select id="campoMetrica" class="form-select">
                            <option value="">-- Selecione após escolher tabela --</option>
                        </select>
                    </div>
                    <div class="col-md-12">
                        <label class="form-label fw-semibold">Agrupar por (Dimensão)</label>
                        <select id="campoDimensao" class="form-select">
                            <option value="">-- Selecione após escolher tabela --</option>
                        </select>
                    </div>
                </div>
            </div>

            <div id="bloco-filtro-lista" class="d-none">
                <div class="row g-3">
                    <div class="col-md-6">
                        <label class="form-label fw-semibold">Filtrar campo (WHERE)</label>
                        <select id="campoFiltro" class="form-select">
                            <option value="">-- Selecione o campo --</option>
                        </select>
                    </div>

                    <div class="col-md-6" id="valor-filtro-container">
                        <label class="form-label fw-semibold">Valor</label>
                        <input type="text" id="valorFiltro" class="form-control" placeholder="Ex: Ativo" />
                    </div>
                </div>
            </div>

            <div class="mt-4 p-3 bg-light rounded-3">
                <h6 class="fw-semibold text-muted mb-3">Filtros Opcionais</h6>
                <div class="row g-3">
                    <div class="col-md-12">
                        <label class="form-label">Campo de Data</label>
                        <select id="campoDataFiltro" class="form-select">
                            <option value="">-- Nenhum filtro --</option>
                        </select>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">De</label>
                        <input type="date" id="dataInicio" class="form-control" />
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">Até</label>
                        <input type="date" id="dataFim" class="form-control" />
                    </div>
                </div>
            </div>
        </div>

    <!-- ========================= -->
    <!-- BOTÕES -->
    <!-- ========================= -->
    <div class="modal-footer border-0">
        <button type="button" class="btn btn-outline-secondary" id="btnPrev" disabled>Voltar</button>
        <button type="button" class="btn btn-primary" id="btnNext" style="background-color:#8A2BE2;border-color:#8A2BE2;">Próximo</button>
        <button type="submit" class="btn btn-success d-none" id="btnFinish">
            <i class="bi bi-check-circle me-1"></i>Salvar Widget
        </button>
    </div>
</form>
