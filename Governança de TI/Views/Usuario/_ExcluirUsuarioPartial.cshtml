@using Governança_de_TI.Models.Usuario
@model UsuarioModel

<form id="formExcluirUsuario" asp-action="ExcluirConfirmado" asp-route-id="@Model.Id" method="post" class="p-3 text-center">
    @Html.AntiForgeryToken()

    <!-- Ícone e título -->
    <div class="mb-3">
        <i class="bi bi-exclamation-triangle-fill text-danger" style="font-size:2.5rem;"></i>
        <h5 class="mt-2 text-danger fw-bold">Confirmar Exclusão</h5>
    </div>

    <!-- Detalhes do usuário -->
    <div class="mb-3">
        @{
            // ==============================
            // Define imagem de perfil
            // ==============================
            var caminho = Model.CaminhoFotoPerfil;
            var fotoSrc = string.IsNullOrEmpty(caminho)
            ? Url.Content("~/img/default-user.png")
            : Url.Content(caminho.StartsWith("/") ? caminho : "/" + caminho);

            // Adiciona um pequeno parâmetro ?v=timestamp
            // para evitar cache caso o arquivo tenha sido alterado recentemente.
            fotoSrc += $"?v={DateTime.Now.Ticks}";
        }

        <img src="@fotoSrc"
             alt="Foto de @Model.Nome"
             class="rounded-circle shadow-sm border mb-2"
             style="width:80px;height:80px;object-fit:cover;transition:all 0.3s ease;" />

        <p class="mt-2 mb-1">
            <strong>@Model.Nome</strong><br />
            <small class="text-muted">@Model.Email</small>
        </p>
    </div>

    <!-- Alerta de confirmação -->
    <div class="alert alert-warning small text-start shadow-sm">
        <i class="bi bi-info-circle me-1"></i>
        Esta ação <strong>não poderá ser desfeita</strong>.<br />
        O usuário será permanentemente removido do sistema.
    </div>

    <!-- Mensagem de sucesso (visível via JS após exclusão) -->
    <div id="excluir-success-msg" class="alert alert-success text-start small shadow-sm d-none mt-3">
        <i class="bi bi-check-circle-fill me-1"></i>
        Usuário excluído com sucesso!
    </div>
</form>

<!-- ===================== SCRIPT OPCIONAL ===================== -->
<script>
    // Exibe feedback após exclusão bem-sucedida
    function mostrarMensagemSucesso() {
        const msg = document.getElementById('excluir-success-msg');
        if (msg) {
            msg.classList.remove('d-none');
            setTimeout(() => msg.classList.add('d-none'), 4000);
        }
    }
</script>
